-- Get the LocalPlayer's name
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local UserName = Player.Name

print(UserName)

-- Define paths
local folder_path = "/" .. getgenv().Config["Folder Name"]
local file_name = getgenv().Config["Config Name"] .. ".json"
local file_path = folder_path .. "/" .. file_name

-- Function to create a folder
local function createFolder()
	makefolder(folder_path)
end

-- Function to create a file
local function createFile()
	local configString = getgenv().Config["Content"]  -- Assuming "Content" is the data to write to the file

	if getgenv().Config["Is Script User Only"] then
		local userPrefix = getgenv().Config["Config for User Only"][1]
		local userSuffix = getgenv().Config["Config for User Only"][2]
		local userFileName = userPrefix .. UserName .. userSuffix .. ".json"

		if getgenv().Config["Is in folder"] then
			writefile(folder_path .. "/" .. userFileName, configString)
		else
			writefile("/" .. userFileName, configString)
		end
	else
		if getgenv().Config["Is in folder"] then
			writefile(file_path, configString)
		else
			writefile("/" .. file_name, configString)
		end
	end
end

-- Check if the folder exists and create it if necessary
if getgenv().Config["Is in folder"] then
	if isfolder(folder_path) then
		if not isfile(file_path) then
			createFile()
		end
	else
		createFolder()
		-- Create the file after creating the folder
		createFile()
	end
else
	if not isfile("/" .. file_name) then
		createFile()
	end
end
